\documentclass[11pt, dvipsnames,aspectratio=169]{beamer}
\usetheme{Madrid}

\usepackage[utf8]{inputenc}
\usepackage{tabularray}	% for "tblr"
\usepackage{graphicx}

% Define the colors used by DNP for branding and addresses/trenches
\usepackage{xcolor}
\definecolor{dnpblue}{RGB}{0,26,174}
\definecolor{dnplightblue}{RGB}{221,226,255}
\definecolor{addressgreen}{RGB}{84,174,74}
\definecolor{addressorange}{RGB}{228,187,114}
\definecolor{addressblue}{RGB}{72,123,182}
\definecolor{addresspink}{RGB}{201,23,199}
\definecolor{addressblack}{RGB}{11,1,2}
\definecolor{trenchgreen}{HTML}{54b04a}
\definecolor{trenchred}{HTML}{db1e2a}
\definecolor{trenchblue}{HTML}{487bb6}
\definecolor{trenchlightblue}{HTML}{00b0f0}
\definecolor{trenchorange}{HTML}{ffba0b}
\definecolor{trenchpurple}{HTML}{873bde}
\definecolor{trenchspuelbohrung}{HTML}{01ffe1}
\definecolor{trenchblack}{HTML}{000000}
\colorlet{beamer@blendedblue}{dnpblue}

% define the fading used on the title slide
\usepackage{tikz}
\usetikzlibrary{fadings,calc}
\tikzfading[name=dnpfading,top color=transparent!100,bottom color=transparent!0]

% dot to signify an address
\newcommand\colordot[1]{\tikz{\draw[white,opacity=0] (0,0) -- (0,-.12);\draw[white,opacity=0] (0,0) -- (.2,0);\node[inner sep=-2,circle,draw=black,fill=#1] at (0,0) {};}}

% short rule to signify a trench
\newcommand\colorrule[1]{\tikz{\draw[white,opacity=0] (0,0) -- (0,-.08);\draw[white,opacity=0] (0,0) -- (.58,0);\fill[#1] (0,0) rectangle (.51,.08);}}


% bulletlist is an itemized list which has a blue bullet before each item
\setbeamertemplate{itemize items}{$\bullet$}
\newenvironment{bulletlist}[1]{\begin{itemize}\setlength{\itemsep}{#1}}{\end{itemize}}

% define a new environment "mapframe" which consists of
%  * a title (#1)
%  * a left column featuring an image (#2) of width #3
%  * a right column containing the content of the environment
% example:
% \begin{mapframe}{Frame title}{/path/to/map.png}{.5\textwidth}
%     (content of the right column)
% \end{mapframe}
\usepackage{environ,calc}
\newcounter{mapframes}
\NewEnviron{mapframe}[3]{\begin{frame}{#1}
	\addtocounter{mapframes}{1}
	\begin{minipage}{#3}
		\tikz[remember picture]{\node[inner sep=0] (map\themapframes) at (0, 0) {\includegraphics[width=\linewidth]{#2}};}
	\end{minipage}\hfill%
	\begin{minipage}{\dimexpr0.99\linewidth-#3}\BODY\end{minipage}
\end{frame}}

% read two CSV files into arrays
\usepackage{readarray}
\readarraysepchar{,}
\readdef{../oberflaechenauswertung.csv}\oberflaechenauswertung
\readarray*\oberflaechenauswertung\oberflaechen[-,\ncols]
\readdef{../adressauswertung.csv}\adressauswertung
\readarray*\adressauswertung\adressen[-,\ncols]

% logo in the bottom right corner
\logo{\includegraphics[width=.1\textwidth]{../Bilder/Logo.png}}
\newcommand{\nologo}{\setbeamertemplate{logo}{}} % command to set the logo to nothing

% info shown in the footline
\author{Deutsche Netzplanung}
\title{Ergebnisse \Ort}
\date{\Abgabedatum}

% No navigation symbols ("next slide"/"previous slide")
\setbeamertemplate{navigation symbols}{}

% make the footline DNP blue
\setbeamercolor{palette primary}{bg=dnpblue,fg=white}
\setbeamercolor{palette secondary}{bg=dnpblue,fg=white}
\setbeamercolor{palette tertiary}{bg=dnpblue,fg=white}

% read custom variables
\input{Commands.tex}
\input{PointsOfInterest.tex}


\begin{document}
	
{
\setbeamertemplate{footline}{}
\begin{frame}
	\begin{tikzpicture}[overlay, remember picture, shift={(current page.south west)}]
		\node[inner sep=0pt] at (10, \paperheight/2) {\includegraphics[height=\paperheight]{../Bilder/adresscheck.png}};
		\fill[dnplightblue,path fading=dnpfading] (0, 0) rectangle (\paperwidth, \paperheight);
		\fill[dnpblue] (0, 0) rectangle  (4.7, \paperheight);
		\node[white,anchor=west] at (.2, 7) {\textbf{Ergebnisse}};
		\node[white,anchor=west] at (.2, 6.6) {\Ort};
		\node[white,anchor=west,text width=4.3cm] at (.2, 5) {\scriptsize Adresscheck und Trenches auf Basis von Bildmaterialien};
		\node[white,anchor=south west] at (.2, .2) {\tiny \Abgabedatum};
		\node[anchor=south east] at (\paperwidth, .1) {\includegraphics[width=.1\textwidth]{../Bilder/Logo.png}};
	\end{tikzpicture}
\end{frame}
}

\addtocounter{framenumber}{-1} %exclude titlepage from page numbering

\begin{frame}{Struktur und Inhalt der Lieferung \Ort}
	\begin{bulletlist}{5pt}
		\item Ergebnis Adresscheck auf Basis von Bildmaterialien
			\begin{bulletlist}{3pt}
				\item[$\bullet$] Übersicht über Anzahl der Adressen und Einheiten
				\item[$\bullet$] Analysebeispiel und Besonderheit, jeweils mit Bild
				\item[$\bullet$] Aufschlüsselung nach Anzahl der Einheiten
			\end{bulletlist}
		\item Ergebnis Trenches auf Basis von Bildmaterialen
		\begin{bulletlist}{3pt}
			\item[$\bullet$] Übersicht konkrete Baumeter inkl. Oberflächenaufteilung und Sonderpositionen
			\item[$\bullet$] Analysebeispiel, typische Oberfläche und Besonderheit jeweils mit Bild
			\item[$\bullet$] Verteilung Trenches mit Handschachtung, Trenches im Straßenkörper, \\ Trenches auf Privatweg
		\end{bulletlist}
		\item Vollständige Plandaten
		\begin{bulletlist}{3pt}
			\item[$\bullet$] Adresskulisse, Trenches inkl. Oberfläche, Fotopunkte, \\ Besonderheiten (GeoPackage)
			\item[$\bullet$] Adressliste, Zusammenfassung Adresscheck, \\ Zusammenfassung Trenches (Excel)
		\end{bulletlist}
	\end{bulletlist}
\end{frame}

\begin{mapframe}{Ergebnis Adresscheck -- Übersicht}{../Bilder/adresscheck.png}{.5\linewidth}
	\centering
	\resizebox{\textwidth}{!}{
		\begin{tblr}{colspec={l@{}l|rrrr},row{1,2}={bg=dnpblue,fg=white,font=\bfseries},row{3,5}={bg=dnplightblue,fg=black},row{6}={font=\bfseries}}
			& Adresskulisse &&&& \\
			&& Adressen & Einheiten GF+ & Einheiten DNP & Differenz \\
			\colordot{addressgreen} & Adresse ohne Lage-Korrektur & \adressen[3,2] & \adressen[3,3] & \adressen[3,4] & \adressen[3,5] \\
			\colordot{addressorange} & Adresse verschoben 		  & \adressen[4,2] & \adressen[4,3] & \adressen[4,4] & \adressen[4,5] \\
			\colordot{addressblue} & Adresse hinzugefügt 		  & \adressen[5,2] & \adressen[5,3] & \adressen[5,4] & \adressen[5,5] \\ \hline[black,wd=1pt]
			& Gesamt & \adressen[6,2] & \adressen[6,3] & \adressen[6,4] & \adressen[6,5] \\
			&&&&& \\
			\colordot{addressblack} & Adresse optimiert & \adressen[9,2] &&& \\
			\colordot{addresspink} & Adresse nicht vorhanden & \adressen[10,2] &&&
		\end{tblr}
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Adresscheck -- Analysebeispiel}{../Bilder/adresscheck.png}{.55\textwidth}
	\centering
	\tikz[remember picture]{
		\node[inner sep=0] (adresseAnalysebeispiel) at (0,0) {\includegraphics[width=5.7cm]{../Bilder/analysebeispiel-adressen.png}};
	} \\
	\tiny \adresseAnalysebeispiel \\
	\vspace{.2cm}
	\resizebox{5.81cm}{!}{
	\begin{tblr}[expand=\einheitenAnalysebeispiel]{colspec={llll},row{1}={bg=dnpblue,fg=white,font=\bfseries},row{2}={bg=dnplightblue,fg=black}}
		& Grunddaten GF+ & Adresscheck DNP & Differenz \\
		Anzahl Einheiten & \einheitenAnalysebeispiel
	\end{tblr}
	}
	\tikz[remember picture,overlay]{
		\coordinate (top1) at ($(map2.north west)!\pointofinterestoneX!(map2.north east)$);
		\coordinate (bottom1) at ($(map2.south west)!\pointofinterestoneX!(map2.south east)$);
		\coordinate (target1) at ($(top1)!\pointofinterestoneY!(bottom1)$);
		\fill[gray,opacity=.3] (target1) -- (adresseAnalysebeispiel.north west) -- (adresseAnalysebeispiel.south west) -- cycle;
		\node[scale=.7,text=white,inner sep=1pt,fill=dnpblue,circle] at (target1) {1};
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Adresscheck -- Besonderheit}{../Bilder/adresscheck.png}{.55\textwidth}
	\centering
	\tikz[remember picture]{
		\node[inner sep=0] (adresseBesonderheit) at (0,0) {\includegraphics[width=5.7cm]{../Bilder/besonderheit-adressen.png}};
	} \\
	\tiny \besonderheitAdressen
	\tikz[remember picture,overlay]{
		\coordinate (top2) at ($(map3.north west)!\pointofinteresttwoX!(map3.north east)$);
		\coordinate (bottom2) at ($(map3.south west)!\pointofinteresttwoX!(map3.south east)$);
		\coordinate (target2) at ($(top2)!\pointofinteresttwoY!(bottom2)$);
		\fill[gray,opacity=.3] (target2) -- (adresseBesonderheit.north west) -- (adresseBesonderheit.south west) -- cycle;
		\node[scale=.7,text=white,inner sep=1pt,fill=dnpblue,circle] at (target2) {2};
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Adresscheck -- Aufschlüsselung nach Anzahl Einheiten}{../Bilder/hp-verteilung.png}{.55\textwidth}
	\begin{bulletlist}{3pt}
		\item[\colordot{addressgreen}] Ein- und Zweifamilienhäuser
		\item[\colordot{addressorange}] Mehrfamilienhäuser
		\item[\colordot{addressblue}] Hochhäuser ($\geqslant$ 12 Einheiten)
	\end{bulletlist}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- Übersicht}{../Bilder/trenches.png}{.5\linewidth}
	\centering
	\resizebox{\textwidth}{!}{
		\begin{tblr}{
			colspec={l@{}lrrrr},
			row{1,2}={bg=dnpblue,fg=white,font=\bfseries},
			row{3,9,12}={bg=dnplightblue,fg=black,font=\bfseries}
		}
			& Tiefbau gesamt &\oberflaechen[1,3]~m &&& \\
			&&& im Straßenkörper & mit Handschachtung & in Privatweg \\
			& Offener Tiefbau								& \oberflaechen[3,3]~m & \oberflaechen[3,5]~m & \oberflaechen[3,7]~m & \oberflaechen[3,9]~m \\
			\colorrule{trenchred} 		& Asphalt 			& \oberflaechen[4,3]~m & \oberflaechen[4,5]~m & \oberflaechen[4,7]~m & \oberflaechen[4,9]~m \\
			\colorrule{trenchblue} 		& Pflaster 			& \oberflaechen[5,3]~m & \oberflaechen[5,5]~m & \oberflaechen[5,7]~m & \oberflaechen[5,9]~m \\
			\colorrule{trenchgreen} 	& Unbefestigt		& \oberflaechen[6,3]~m & \oberflaechen[6,5]~m & \oberflaechen[6,7]~m & \oberflaechen[6,9]~m \\
			\colorrule{trenchpurple} 	& Mosaikpflaster	& \oberflaechen[7,3]~m & \oberflaechen[7,5]~m & \oberflaechen[7,7]~m & \oberflaechen[7,9]~m \\
			\colorrule{trenchlightblue} & Kopfsteinpflaster	& \oberflaechen[8,3]~m & \oberflaechen[8,5]~m & \oberflaechen[8,7]~m & \oberflaechen[8,9]~m \\
			& Geschlossener Tiefbau & \oberflaechen[10,3]~m &&& \oberflaechen[10,9]~m \\
			\colorrule{trenchorange} 	& Rohrpressung 		& \oberflaechen[11,3]~m &&& \oberflaechen[11,9]~m \\
			\colorrule{trenchspuelbohrung} & Spülbohrung 	& \oberflaechen[12,3]~m &&& \oberflaechen[12,9]~m \\
			& Sonderquerungen &&&& \\
			& Bahn & \oberflaechen[15,3]~St. &&& \\
			& Bachquerung & \oberflaechen[16,3]~St. &&& \\
		\end{tblr}
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- Analysebeispiel}{../Bilder/trenches.png}{.6\textwidth}
	\centering
	\tikz[remember picture]{
		\node[inner sep=0] (trenchesAnalysebeispiel) at (0,0) {\includegraphics[width=\linewidth]{../Bilder/analysebeispiel-trenches.png}};
	} \\
	\tiny Konkrete Baumeter auf Basis der Adresskulisse
	\tikz[remember picture,overlay]{
		\coordinate (top3) at ($(map6.north west)!\pointofinterestthreeX!(map6.north east)$);
		\coordinate (bottom3) at ($(map6.south west)!\pointofinterestthreeX!(map6.south east)$);
		\coordinate (target3) at ($(top3)!\pointofinterestthreeY!(bottom3)$);
		\fill[gray,opacity=.3] (target3) -- (trenchesAnalysebeispiel.north west) -- (trenchesAnalysebeispiel.south west) -- cycle;
		\node[scale=.7,text=white,inner sep=1pt,fill=dnpblue,circle] at (target3) {3};
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- typische Oberfläche}{../Bilder/trenches.png}{.6\textwidth}
	\centering
	\tikz[remember picture]{
		\node[inner sep=0] (trenchesTypisch) at (0,0) {\includegraphics[width=\linewidth]{../Bilder/typische-oberflaeche.png}};
	} \\
	\tiny \typischeOberflaeche
	\tikz[remember picture,overlay]{
		\coordinate (top4) at ($(map7.north west)!\pointofinterestfourX!(map7.north east)$);
		\coordinate (bottom4) at ($(map7.south west)!\pointofinterestfourX!(map7.south east)$);
		\coordinate (target4) at ($(top4)!\pointofinterestfourY!(bottom4)$);
		\fill[gray,opacity=.3] (target4) -- (trenchesTypisch.north west) -- (trenchesTypisch.south west) -- cycle;
		\node[scale=.7,text=white,inner sep=1pt,fill=dnpblue,circle] at (target4) {4};
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- Besonderheit}{../Bilder/trenches.png}{.6\textwidth}
	\centering
	\tikz[remember picture]{
		\node[inner sep=0] (trenchesBesonderheit) at (0,0) {\includegraphics[width=\linewidth]{../Bilder/besonderheit-trenches.png}};
	} \\
	\tiny \besonderheitTrenches
	\tikz[remember picture,overlay]{
		\coordinate (top5) at ($(map8.north west)!\pointofinterestfiveX!(map8.north east)$);
		\coordinate (bottom5) at ($(map8.south west)!\pointofinterestfiveX!(map8.south east)$);
		\coordinate (target5) at ($(top5)!\pointofinterestfiveY!(bottom5)$);
		\fill[gray,opacity=.3] (target5) -- (trenchesBesonderheit.north west) -- (trenchesBesonderheit.south west) -- cycle;
		\node[scale=.7,text=white,inner sep=1pt,fill=dnpblue,circle] at (target5) {5};
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- Sonderquerung}{../Bilder/trenches.png}{.6\textwidth}
	\centering
	\tikz[remember picture]{
		\node[inner sep=0] (trenchesSonderquerung) at (0,0) {\includegraphics[width=\linewidth]{../Bilder/sonderquerung.png}};
	} \\
	\tiny \sonderquerung
	\tikz[remember picture,overlay]{
		\coordinate (top6) at ($(map9.north west)!\pointofinterestsixX!(map9.north east)$);
		\coordinate (bottom6) at ($(map9.south west)!\pointofinterestsixX!(map9.south east)$);
		\coordinate (target6) at ($(top6)!\pointofinterestsixY!(bottom6)$);
		\fill[gray,opacity=.3] (target6) -- (trenchesSonderquerung.north west) -- (trenchesSonderquerung.south west) -- cycle;
		\node[scale=.7,text=white,inner sep=1pt,fill=dnpblue,circle] at (target6) {6};
	}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- Verteilung Handschachtung}{../Bilder/trenches-handschachtung.png}{.6\textwidth}
	\begin{itemize}
		\item[\colorrule{trenchgreen}] Trench \textbf{mit} Handschachtung
		\item[\colorrule{trenchblack}] Trench \textbf{ohne} Handschachtung
	\end{itemize}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- Verteilung Trench im Straßenkörper}{../Bilder/trenches-strassenkoerper.png}{.6\textwidth}
	\begin{itemize}
		\item[\colorrule{trenchred}] Trench im \textbf{Straßenkörper}
		\item[\colorrule{trenchblack}] Trench im \textbf{Gehweg}
	\end{itemize}
\end{mapframe}

\begin{mapframe}{Ergebnis Trenches -- Verteilung Trench auf Privatweg}{../Bilder/trenches-privatweg.png}{.6\textwidth}
	\begin{itemize}
		\item[\colorrule{trenchblue}] Trench auf \textbf{Privatweg}
		\item[\colorrule{trenchblack}] Trench auf \textbf{öffentlichem Grund}
	\end{itemize}
\end{mapframe}


\end{document}